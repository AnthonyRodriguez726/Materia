(function(){var __indexOf=[].indexOf||function(item){for(var i=0,l=this.length;l>i;i++)if(i in this&&this[i]===item)return i;return-1};Namespace("Materia").QuestionImporter=function(){var $selectedAssets,$table,init,_getQuestions,_getType,_loadAllQuestions,_loadSelectedQuestions,_setupTable;return $selectedAssets=[],$table=null,init=function(){return $(document).ready(function(){return _setupTable(),_loadAllQuestions()})},_setupTable=function(){return $(document).on("click","#question-table tbody tr",function(e){var $checkbox,$selected;return $checkbox=$(this).find(":checkbox"),$selected=$(this).toggleClass("row_selected").hasClass("row_selected"),$checkbox.prop("checked",$selected),"checkbox"===e.target.type&&e.stopPropagation(),$selected?$selectedAssets.push($checkbox.prop("value")):$selectedAssets.splice($selectedAssets.indexOf($checkbox.prop("value")),1)}),$("#submit-button").click(function(e){return e.stopPropagation(),_loadSelectedQuestions($selectedAssets),!1}),$(window).bind("hashchange",_loadAllQuestions),$(window).resize(function(){return $("div.dataTables_scrollBody").height($(window).height()-150),$table.fnAdjustColumnSizing()}),$table=$("#question-table").dataTable({bPaginate:!1,bLengthChange:!0,bAutoWidth:!0,bProcessing:!0,sScrollY:"500px",oLanguage:{sSearch:"",sInfoFiltered:" / _MAX_",sInfo:"showing: _TOTAL_"},aoColumns:[{mDataProp:"text"},{mDataProp:"type"},{mDataProp:"created_at"},{mDataProp:"uses"}],aaSorting:[[2,"desc"]],aoColumnDefs:[{fnRender:function(oObj,sVal){var d;return d=new Date(1e3*sVal),d.getMonth()+1+"/"+d.getDate()+"/"+d.getFullYear()},aTargets:[2]},{fnRender:function(oObj,sVal){return'<input type="checkbox" name="id" value="'+oObj.aData.id+'" > <span class="q">'+sVal+"</span>"},aTargets:[0]}]}),$("div.dataTables_scrollBody").height($(window).height()-150)},_loadAllQuestions=function(){var questionTypes;return $selectedAssets=[],$("#question-table").dataTable().fnClearTable(),questionTypes=_getType(),_getQuestions(null,questionTypes,function(result){return null!==result&&!(__indexOf.call(result,"msg")>=0)&&result.length>0?($("#question-table").dataTable().fnClearTable(),$("#question-table").dataTable().fnAddData(result)):void 0})},_getQuestions=function(questionIds,questionTypes,callback){return Materia.Coms.Json.send("questions_get",[questionIds,questionTypes],callback)},_loadSelectedQuestions=function(questionIds){return _getQuestions(questionIds,null,function(result){return null!=result&&!("msg"in result)&&result.length>0?window.opener.Materia.Creator.onQuestionImportComplete(JSON.stringify(result)):void 0})},_getType=function(){var l,type;return l=document.location.href,type=l.substring(l.lastIndexOf("=")+1)},{init:init}}()}).call(this);