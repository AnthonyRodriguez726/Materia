(function(){Namespace("Materia.Storage").Manager=function(){var addTable,clean,getTable,insert,_tables;return _tables=[],addTable=function(){var columns,i,id,newTable,table,_i,_j,_len,_ref;for(id=arguments[0],columns=[],i=_i=1,_ref=arguments.length-1;_ref>=1?_ref>=_i:_i>=_ref;i=_ref>=1?++_i:--_i)columns.push(arguments[i]);for(_j=0,_len=_tables.length;_len>_j&&(table=_tables[_j],table.getId()!==clean(id));_j++);if(null==table)return newTable=Materia.Storage.Table(),newTable.init(clean(id),columns),_tables.push(newTable);throw new Error("Table '${id}' already exists")},insert=function(){var i,result,table,tableId,values,_i,_j,_len,_ref;for(tableId=arguments[0],values=[],i=_i=1,_ref=arguments.length-1;_ref>=1?_ref>=_i:_i>=_ref;i=_ref>=1?++_i:--_i)values.push(arguments[i]);for(_j=0,_len=_tables.length;_len>_j&&(table=_tables[_j],table.getId()!==clean(tableId));_j++);if(null==table)throw new Error("Data table '"+tableId+"'' does not exist.");return result=table.insert(values),Materia.Engine.sendStorage(result)},getTable=function(tableID){var i,table,_i,_ref;for(i=_i=1,_ref=_tables.length-1;(_ref>=1?_ref>=_i:_i>=_ref)&&(table=_tables[i],table.getId()!==StorageTable.clean(tableID));i=_ref>=1?++_i:--_i);if(null==table)throw new Error("Data table '"+tableID+"' does not exist.");return table},clean=function(name){var cleanName;if(cleanName=name.replace(/^([ ]+)/,""),cleanName=cleanName.replace(/\s+$/g,""),cleanName=cleanName.replace(/\s/g,"_"),"userName"===cleanName||"firstName"===cleanName||"lastName"===cleanName||"timestamp"===cleanName||"playID"===cleanName)throw new Error('Column name "'+name+'" is a protected keyword');return cleanName},{addTable:addTable,clean:clean,insert:insert,getTable:getTable}}()}).call(this);