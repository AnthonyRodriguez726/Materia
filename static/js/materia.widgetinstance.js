(function(){Namespace("Materia").WidgetInstance=function(){var clearAll,get,getAll,updateWidget,_getFromServer,_gotAll,_widgetIds,_widgets;return _widgets=null,_widgetIds={},_gotAll=!1,_getFromServer=function(getWhat,callback){return null!=getWhat&&(getWhat=[[getWhat]]),Materia.Coms.Json.send("widget_instances_get",getWhat,function(widgets){var i,w,_i,_ref;if(_widgets=[],null!=widgets&&null!=widgets.length)for(i=_i=0,_ref=widgets.length;_ref>=0?_ref>_i:_i>_ref;i=_ref>=0?++_i:--_i)w=widgets[i],_widgetIds[w.id]=w,_widgets.push(w),w.searchCache=(""+w.id+" "+w.widget.name+" "+w.name).toLowerCase();return callback(_widgets)})},clearAll=function(){return _widgets=null,_widgetIds={},_gotAll=!1},getAll=function(callback){return null!=_widgets&&_gotAll?callback(_widgets):(_gotAll=!0,_getFromServer(null,callback))},get=function(id,callback){return null!=_widgetIds[id]?callback(_widgetIds[id]):_getFromServer(id,callback)},updateWidget=function(widget){var i,_i,_ref;for(i=_i=0,_ref=_widgets.length;_ref>=0?_ref>_i:_i>_ref;i=_ref>=0?++_i:--_i)if(_widgets[i]===widget.id){_widgets[i]=widget;break}return _widgetIds[widget.id]=widget,null},{clearAll:clearAll,updateWidget:updateWidget,getAll:getAll,get:get}}()}).call(this);